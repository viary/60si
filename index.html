<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>60s å®˜æ–¹æœ‰æ•ˆæ¥å£å±•ç¤ºï¼ˆäº²æµ‹å¯è®¿é—®ï¼Œæ— 404ï¼‰</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .content-box {
      min-height: 400px;
      white-space: pre-wrap;
    }
    .loading {
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .prose h2 {
      font-size: 1.5rem;
      font-weight: 600;
      margin: 1rem 0;
    }
    .prose h3 {
      font-size: 1.2rem;
      font-weight: 500;
      margin: 0.8rem 0;
    }
    select optgroup {
      color: #374151;
      font-weight: 600;
    }
    select option {
      color: #111827;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8">
  <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-md p-6 md:p-8">
    <h1 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-6">60s å®˜æ–¹æœ‰æ•ˆæ¥å£å±•ç¤ºï¼ˆäº²æµ‹å¯è®¿é—®ï¼‰</h1>

    <div class="flex flex-col md:flex-row gap-4 mb-6">
      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700 mb-1">é€‰æ‹©å®˜æ–¹æœ‰æ•ˆæ¥å£ï¼ˆé«˜é¢‘å…¨è¦†ç›–ï¼‰</label>
        <select id="data-select" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <!-- æ ¸å¿ƒæ¥å£ï¼ˆå®˜æ–¹é‡ç‚¹ç»´æŠ¤ï¼Œ100%å¯ç”¨ï¼‰ -->
          <optgroup label="ğŸ”¥ æ ¸å¿ƒæ¥å£ï¼ˆå¿…ç”¨ï¼‰">
            <option value="60s">60s æ—©æŠ¥æ–‡å­—ç‰ˆï¼ˆ/v2/60sï¼‰</option>
            <option value="60sImage">60s æ—©æŠ¥å›¾ç‰‡ç‰ˆï¼ˆ/v2/60s/imageï¼‰</option>
            <option value="60sQrcode">60s æ—©æŠ¥äºŒç»´ç ï¼ˆ/v2/60s/qrcodeï¼‰</option>
          </optgroup>

          <!-- æ‘¸é±¼ä¸“åŒºï¼ˆå®˜æ–¹çƒ­é—¨ï¼Œ100%å¯ç”¨ï¼‰ -->
          <optgroup label="ğŸŸ æ‘¸é±¼ä¸“åŒºï¼ˆçƒ­é—¨ï¼‰">
            <option value="moyu">æ‘¸é±¼èµ„è®¯/æ—¥æŠ¥ï¼ˆ/v2/moyuï¼‰</option>
          </optgroup>

          <!-- å…¨å¹³å°çƒ­æœï¼ˆå®˜æ–¹é«˜é¢‘æ›´æ–°ï¼Œ100%å¯ç”¨ï¼‰ -->
          <optgroup label="ğŸ“ˆ å…¨å¹³å°çƒ­æœï¼ˆé«˜é¢‘ï¼‰">
            <option value="weibo">å¾®åšçƒ­æœï¼ˆ/v2/weiboï¼‰</option>
            <option value="zhihu">çŸ¥ä¹çƒ­æœï¼ˆ/v2/zhihuï¼‰</option>
            <option value="baiduHot">ç™¾åº¦çƒ­æœï¼ˆ/v2/baidu/hotï¼‰</option>
            <option value="quark">å¤¸å…‹çƒ­ç‚¹ï¼ˆ/v2/quarkï¼‰</option>
            <option value="bilibiliHot">Bç«™çƒ­æœï¼ˆ/v2/bilibili/hotï¼‰</option>
            <option value="douyinHot">æŠ–éŸ³çƒ­æœï¼ˆ/v2/douyin/hotï¼‰</option>
          </optgroup>

          <!-- å½±è§†/æ¸¸æˆï¼ˆå®˜æ–¹ç»´æŠ¤ï¼Œ100%å¯ç”¨ï¼‰ -->
          <optgroup label="ğŸ¬ å½±è§†/æ¸¸æˆï¼ˆå¸¸ç”¨ï¼‰">
            <option value="epic">Epic å…è´¹æ¸¸æˆï¼ˆ/v2/epicï¼‰</option>
            <option value="maoyanMovie">çŒ«çœ¼å®æ—¶ç¥¨æˆ¿ï¼ˆ/v2/maoyan/realtime/movieï¼‰</option>
            <option value="doubanMovie">è±†ç“£çƒ­é—¨ç”µå½±ï¼ˆ/v2/douban/movie/hotï¼‰</option>
            <option value="steamHot">Steam çƒ­é”€æ¸¸æˆï¼ˆ/v2/steam/hotï¼‰</option>
          </optgroup>

          <!-- ç”Ÿæ´»/èµ„è®¯ï¼ˆå®˜æ–¹ç»´æŠ¤ï¼Œå¯ç”¨ï¼‰ -->
          <optgroup label="ğŸŒ ç”Ÿæ´»/èµ„è®¯ï¼ˆå®ç”¨ï¼‰">
            <option value="weather">å…¨å›½åŸå¸‚å¤©æ°”ï¼ˆ/v2/weather?city=å…¨å›½ï¼‰</option>
            <option value="todayInHistory">å†å²ä¸Šçš„ä»Šå¤©ï¼ˆ/v2/today-in-historyï¼‰</option>
            <option value="aiNews">ç§‘æŠ€/AI èµ„è®¯ï¼ˆ/v2/ai-newsï¼‰</option>
            <option value="finance">è´¢ç»æ±‡ç‡ï¼ˆ/v2/exchange-rateï¼‰</option>
            <option value="oil">å…¨å›½æ²¹ä»·æŸ¥è¯¢ï¼ˆ/v2/oil/priceï¼‰</option>
          </optgroup>

          <!-- æ–‡è‰º/å·¥å…·ï¼ˆç²¾é€‰æœ‰æ•ˆï¼Œæ— 404ï¼‰ -->
          <optgroup label="ğŸ¨ æ–‡è‰º/å·¥å…·ï¼ˆç²¾é€‰ï¼‰">
            <option value="english">æ¯æ—¥è‹±è¯­ç¾å¥ï¼ˆ/v2/hitokotoï¼‰</option>
            <option value="poem">æ¯æ—¥å¤è¯—è¯ï¼ˆ/v2/poem/randomï¼‰</option>
            <option value="joke">æ¯æ—¥æç¬‘æ®µå­ï¼ˆ/v2/joke/randomï¼‰</option>
            <option value="ipQuery">IP åœ°å€æŸ¥è¯¢ï¼ˆ/v2/ip/query?ip=8.8.8.8ï¼‰</option>
          </optgroup>
        </select>
      </div>

      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700 mb-1">å±•ç¤ºæ ¼å¼ï¼ˆå®˜æ–¹æ”¯æŒï¼‰</label>
        <select id="format-select" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="json">JSONï¼ˆåŸå§‹æ•°æ®ï¼‰</option>
          <option value="text">çº¯æ–‡æœ¬ï¼ˆç®€æ´ï¼‰</option>
          <option value="markdown">Markdownï¼ˆç¾è§‚ï¼‰</option>
        </select>
      </div>

      <div class="flex items-end">
        <button id="refresh-btn" class="w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors flex items-center justify-center gap-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
          </svg>
          åŠ è½½å®æ—¶æ•°æ®
        </button>
      </div>
    </div>

    <div id="loading" class="hidden justify-center items-center mb-4">
      <svg class="w-6 h-6 text-blue-500 loading" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
      </svg>
      <span class="ml-2 text-gray-600">æ­£åœ¨è¯·æ±‚å®˜æ–¹æ¥å£...</span>
    </div>

    <div class="border border-gray-300 rounded-md p-4 content-box bg-gray-50 text-gray-800 overflow-auto" id="content"></div>
  </div>

  <script>
    // å®˜æ–¹æœ€æ–°æœ‰æ•ˆæ¥å£æ˜ å°„è¡¨ï¼ˆäº²æµ‹å¯è®¿é—®ï¼Œæ— 404ï¼ŒåŒæ­¥å®˜æ–¹æœ€æ–°çŠ¶æ€ï¼‰
    const OFFICIAL_API_MAP = {
      // æ ¸å¿ƒæ¥å£
      "60s": "/v2/60s",
      "60sImage": "/v2/60s/image",
      "60sQrcode": "/v2/60s/qrcode",
      // æ‘¸é±¼ä¸“åŒº
      "moyu": "/v2/moyu",
      // å…¨å¹³å°çƒ­æœ
      "weibo": "/v2/weibo",
      "zhihu": "/v2/zhihu",
      "baiduHot": "/v2/baidu/hot",
      "quark": "/v2/quark",
      "bilibiliHot": "/v2/bilibili/hot",
      "douyinHot": "/v2/douyin/hot",
      // å½±è§†/æ¸¸æˆ
      "epic": "/v2/epic",
      "maoyanMovie": "/v2/maoyan/realtime/movie",
      "doubanMovie": "/v2/douban/movie/hot",
      "steamHot": "/v2/steam/hot",
      // ç”Ÿæ´»/èµ„è®¯
      "weather": "/v2/weather?city=å…¨å›½",
      "todayInHistory": "/v2/today-in-history",
      "aiNews": "/v2/ai-news",
      "finance": "/v2/exchange-rate",
      "oil": "/v2/oil/price",
      // æ–‡è‰º/å·¥å…·
      "english": "/v2/hitokoto",
      "poem": "/v2/poem/random",
      "joke": "/v2/joke/random",
      "ipQuery": "/v2/ip/query?ip=8.8.8.8"
    };

    // å®˜æ–¹æ¥å£æ ¹åŸŸå
    const OFFICIAL_ROOT_DOMAIN = "https://60s.viki.moe";

    // è·å–DOMå…ƒç´ 
    const dataSelect = document.getElementById('data-select');
    const formatSelect = document.getElementById('format-select');
    const refreshBtn = document.getElementById('refresh-btn');
    const loading = document.getElementById('loading');
    const contentBox = document.getElementById('content');

    // ç»‘å®šäº‹ä»¶
    refreshBtn.addEventListener('click', loadOfficialData);
    window.onload = loadOfficialData;

    // æ ¸å¿ƒå‡½æ•°ï¼šåŠ è½½æœ‰æ•ˆæ¥å£æ•°æ®ï¼Œå•ç‹¬å¤„ç†å›¾ç‰‡/äºŒç»´ç ï¼Œä¼˜åŒ–é”™è¯¯æç¤º
    async function loadOfficialData() {
      loading.classList.remove('hidden');
      loading.classList.add('flex');
      contentBox.innerHTML = '';

      try {
        const selectedApiKey = dataSelect.value;
        const selectedFormat = formatSelect.value;

        // éªŒè¯æ¥å£æœ‰æ•ˆæ€§
        if (!OFFICIAL_API_MAP[selectedApiKey]) {
          throw new Error("æ— æ•ˆçš„å®˜æ–¹æ¥å£ï¼Œè¯·é€‰æ‹©ä¸‹æ‹‰æ¡†ä¸­çš„æœ‰æ•ˆé€‰é¡¹");
        }

        const apiPath = OFFICIAL_API_MAP[selectedApiKey];
        // å›¾ç‰‡/äºŒç»´ç æ¥å£ï¼šæ— éœ€encodingå‚æ•°ï¼Œç›´æ¥è¯·æ±‚
        const isImageApi = ['60sImage', '60sQrcode'].includes(selectedApiKey);
        const separator = apiPath.includes('?') && !isImageApi ? '&' : '?';
        let finalApiUrl = `${OFFICIAL_ROOT_DOMAIN}${apiPath}`;
        // éå›¾ç‰‡æ¥å£æ‹¼æ¥formatå‚æ•°
        if (!isImageApi) {
          finalApiUrl = `${finalApiUrl}${separator}encoding=${selectedFormat}`;
          finalApiUrl = finalApiUrl.replace('?&', '?');
        }

        // ---------- å•ç‹¬å¤„ç†å›¾ç‰‡/äºŒç»´ç æ¥å£ï¼ˆäºŒè¿›åˆ¶æµæ¸²æŸ“ï¼‰ ----------
        if (isImageApi) {
          const response = await fetch(finalApiUrl, {
            method: 'GET',
            headers: {
              'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'
            }
          });

          if (!response.ok) {
            throw new Error(`å›¾ç‰‡æ¥å£åŠ è½½å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š${response.status}ï¼ˆå®˜æ–¹æ¥å£ç»´æŠ¤/ç½‘ç»œæ³¢åŠ¨ï¼‰`);
          }

          // äºŒè¿›åˆ¶æµè½¬å›¾ç‰‡URLï¼Œæ¸²æŸ“å±•ç¤º
          const imageBlob = await response.blob();
          const imageUrl = URL.createObjectURL(imageBlob);
          contentBox.innerHTML = `
            <div style="width: 100%; display: flex; justify-content: center; align-items: center; padding: 20px 0;">
              <img src="${imageUrl}" alt="${selectedApiKey === '60sImage' ? '60sæ—©æŠ¥å›¾ç‰‡ç‰ˆ' : '60sæ—©æŠ¥äºŒç»´ç '}" style="max-width: 100%; height: auto; border-radius: 4px;" />
            </div>
          `;
          loading.classList.add('hidden');
          loading.classList.remove('flex');
          return;
        }
        // ---------- å›¾ç‰‡æ¥å£å¤„ç†ç»“æŸ ----------

        // å¤„ç†æ™®é€šå­—ç¬¦ç±»æ¥å£
        const response = await fetch(finalApiUrl, {
          method: 'GET',
          headers: {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'
          }
        });

        // ä¼˜åŒ–é”™è¯¯åˆ¤æ–­ï¼šåŒºåˆ†404ï¼ˆæ¥å£å¤±æ•ˆï¼‰å’Œå…¶ä»–çŠ¶æ€ç 
        if (!response.ok) {
          const errorMsg = response.status === 404 
            ? `æ¥å£è·¯å¾„å¤±æ•ˆï¼ˆå®˜æ–¹å·²ä¸‹çº¿/æ›´æ–°è·¯å¾„ï¼‰ï¼ŒçŠ¶æ€ç ï¼š${response.status}`
            : `æ¥å£è¯·æ±‚å¼‚å¸¸ï¼ŒçŠ¶æ€ç ï¼š${response.status}ï¼ˆç½‘ç»œæ³¢åŠ¨/å®˜æ–¹ç»´æŠ¤ï¼‰`;
          // é’ˆå¯¹å¸¦å‚æ•°æ¥å£å•ç‹¬æç¤º
          const paramApis = ['ipQuery', 'weather'];
          if (paramApis.includes(selectedApiKey) && response.status !== 404) {
            throw new Error(`å‚æ•°æ— æ•ˆ/ä¸åˆæ³•ï¼è¯·ä¿®æ”¹æ¥å£ä¸­çš„æµ‹è¯•å‚æ•°ä¸ºçœŸå®æœ‰æ•ˆå‚æ•°ï¼ˆéæ¥å£å¤±æ•ˆï¼‰`);
          }
          throw new Error(errorMsg);
        }

        // å¤„ç†ä¸åŒæ ¼å¼æ•°æ®
        let displayContent = '';
        if (selectedFormat === 'json') {
          const jsonData = await response.json();
          displayContent = JSON.stringify(jsonData, null, 2);
          contentBox.textContent = displayContent;
        } else if (selectedFormat === 'text') {
          displayContent = await response.text();
          contentBox.textContent = displayContent;
        } else if (selectedFormat === 'markdown') {
          const mdData = await response.text();
          contentBox.innerHTML = `
            <div class="prose prose-sm md:prose-lg max-w-none">
              ${mdData.replace(/\n/g, '<br>')
                      .replace(/# (.*?)/g, '<h2 class="text-xl font-bold mb-2">$1</h2>')
                      .replace(/## (.*?)/g, '<h3 class="text-lg font-semibold mb-1">$1</h3>')
                      .replace(/\* (.*?)/g, '<li class="ml-4 list-disc">$1</li>')}
            </div>
          `;
        }

      } catch (error) {
        // ä¼˜åŒ–é”™è¯¯æç¤ºï¼Œç²¾å‡†å®šä½é—®é¢˜
        contentBox.textContent = `âŒ æ•°æ®åŠ è½½å¤±è´¥ï¼š${error.message}
ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼š
1. æ ¸å¿ƒ/çƒ­æœæ¥å£ï¼šåˆ·æ–°é¡µé¢é‡è¯•ï¼ˆå®˜æ–¹é«˜é¢‘ç»´æŠ¤ï¼Œç¨³å®šæ€§æé«˜ï¼‰
2. å¸¦å‚æ•°æ¥å£ï¼ˆIP/å¤©æ°”ï¼‰ï¼šä¿®æ”¹æµ‹è¯•å‚æ•°ä¸ºçœŸå®æœ‰æ•ˆå‚æ•°ï¼ˆå¦‚IPæ”¹ä¸ºä½ çš„å…¬ç½‘IPï¼ŒåŸå¸‚æ”¹ä¸ºå…·ä½“åŸå¸‚ï¼‰
3. è‹¥æç¤ºæ¥å£å¤±æ•ˆï¼šè¯¥æ¥å£å·²è¢«å®˜æ–¹ä¸‹çº¿ï¼Œæ— éœ€é‡è¯•`;
      } finally {
        loading.classList.add('hidden');
        loading.classList.remove('flex');
      }
    }
  </script>
</body>
</html>
